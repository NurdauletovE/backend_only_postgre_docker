# 🏛️ Technical Architecture Diagrams

## 📊 System Architecture Overview

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                          External Interfaces                                    │
├─────────────────────────────────────────────────────────────────────────────────┤
│  REST API Clients    │  SIEM Systems    │  Grafana Dashboards  │  Compliance    │
│  (curl, Postman)     │  (Splunk, QRadar)│  (Monitoring)        │  Authorities   │
└─────────────┬─────────┴──────────┬───────┴─────────────┬─────────┴──────────────┘
              │                    │                     │
              ▼                    ▼                     ▼
┌─────────────────────────────────────────────────────────────────────────────────┐
│                              API Gateway Layer                                  │
├─────────────────────────────────────────────────────────────────────────────────┤
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐       │
│  │   FastAPI    │  │    Nginx     │  │   SSL/TLS    │  │   Rate       │       │
│  │   Server     │  │   Reverse    │  │  Termination │  │  Limiting    │       │
│  │   :8000      │  │    Proxy     │  │              │  │              │       │
│  └──────────────┘  └──────────────┘  └──────────────┘  └──────────────┘       │
└─────────────┬─────────────────────────────────────────────────────────────────┘
              │
              ▼
┌─────────────────────────────────────────────────────────────────────────────────┐
│                         Core Application Layer                                  │
├─────────────────────────────────────────────────────────────────────────────────┤
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐       │
│  │  Compliance  │  │   Security   │  │  Monitoring  │  │ Integration  │       │
│  │    Agent     │  │  Framework   │  │   & Metrics  │  │   Manager    │       │
│  │              │  │              │  │              │  │              │       │
│  │ • Scanning   │  │ • JWT Auth   │  │ • Prometheus │  │ • Kafka SIEM │       │
│  │ • Scheduling │  │ • Hardening  │  │ • Grafana    │  │ • Webhooks   │       │
│  │ • Reporting  │  │ • Logging    │  │ • Alerting   │  │ • API Calls  │       │
│  └──────────────┘  └──────────────┘  └──────────────┘  └──────────────┘       │
└─────────────┬─────────────────────────────────────────────────────────────────┘
              │
              ▼
┌─────────────────────────────────────────────────────────────────────────────────┐
│                          Plugin Architecture                                    │
├─────────────────────────────────────────────────────────────────────────────────┤
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐       │
│  │     CIS      │  │    NIST      │  │     SOC2     │  │   Custom     │       │
│  │   Plugin     │  │   Plugin     │  │   Plugin     │  │   Plugins    │       │
│  │              │  │              │  │              │  │              │       │
│  │ • Ubuntu     │  │ • Framework  │  │ • Controls   │  │ • Org Rules  │       │
│  │ • RHEL       │  │ • Controls   │  │ • Evidence   │  │ • Industry   │       │
│  │ • Custom     │  │ • Assessment │  │ • Reporting  │  │ • Standards  │       │
│  └──────────────┘  └──────────────┘  └──────────────┘  └──────────────┘       │
└─────────────┬─────────────────────────────────────────────────────────────────┘
              │
              ▼
┌─────────────────────────────────────────────────────────────────────────────────┐
│                           Data Layer                                            │
├─────────────────────────────────────────────────────────────────────────────────┤
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐       │
│  │ PostgreSQL   │  │    Redis     │  │  File System │  │  External    │       │
│  │   Database   │  │    Cache     │  │   Storage    │  │  Storage     │       │
│  │              │  │              │  │              │  │              │       │
│  │ • Systems    │  │ • Sessions   │  │ • Scan Files │  │ • S3 Bucket  │       │
│  │ • Scans      │  │ • Metrics    │  │ • Reports    │  │ • NFS Mount  │       │
│  │ • Attestations│ │ • Temp Data  │  │ • Logs       │  │ • Backup     │       │
│  │ • Audit Logs │  │              │  │ • Keys       │  │              │       │
│  └──────────────┘  └──────────────┘  └──────────────┘  └──────────────┘       │
└─────────────────────────────────────────────────────────────────────────────────┘
```

## 🔄 Compliance Scanning Workflow

```
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   System    │    │   Agent     │    │  OpenSCAP   │    │  Database   │
│ Registration│    │ Scheduler   │    │   Scanner   │    │   Storage   │
└──────┬──────┘    └──────┬──────┘    └──────┬──────┘    └──────┬──────┘
       │                  │                  │                  │
       │ 1. Register      │                  │                  │
       │ Target System    │                  │                  │
       ├─────────────────►│                  │                  │
       │                  │                  │                  │
       │                  │ 2. Schedule Scan │                  │
       │                  │ (Cron/API)       │                  │
       │                  ├─────────────────►│                  │
       │                  │                  │                  │
       │                  │                  │ 3. Execute       │
       │                  │                  │ CIS Benchmark    │
       │                  │                  │ Assessment       │
       │                  │                  │                  │
       │                  │ 4. Raw Results   │                  │
       │                  │ (XML/JSON)       │                  │
       │                  │◄─────────────────┤                  │
       │                  │                  │                  │
       │                  │ 5. Process &     │                  │
       │                  │ Parse Results    │                  │
       │                  │                  │                  │
       │                  │ 6. Store Scan    │                  │
       │                  │ Results          │                  │
       │                  ├─────────────────────────────────────►│
       │                  │                  │                  │
       │                  │ 7. Generate JWT  │                  │
       │                  │ Attestation      │                  │
       │                  │                  │                  │
       │                  │ 8. Store         │                  │
       │                  │ Attestation      │                  │
       │                  ├─────────────────────────────────────►│
       │                  │                  │                  │
       │ 9. Compliance    │                  │                  │
       │ Certificate      │                  │                  │
       │ (JWT)           │                  │                  │
       │◄─────────────────┤                  │                  │
       │                  │                  │                  │
```

## 🔐 Security Architecture

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                            Security Layers                                      │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                 │
│  ┌─────────────────────────────────────────────────────────────────────────┐   │
│  │                      Application Security                                │   │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐    │   │
│  │  │    JWT      │  │    RBAC     │  │  Input      │  │   Output    │    │   │
│  │  │ Attestation │  │ Controls    │  │ Validation  │  │ Sanitization│    │   │
│  │  │             │  │             │  │             │  │             │    │   │
│  │  │ • RS256     │  │ • Admin     │  │ • Pydantic  │  │ • XSS Prev  │    │   │
│  │  │ • Claims    │  │ • Operator  │  │ • Schema    │  │ • CSRF Prot │    │   │
│  │  │ • Expiry    │  │ • Viewer    │  │ • Types     │  │ • Headers   │    │   │
│  │  └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘    │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │
│                                                                                 │
│  ┌─────────────────────────────────────────────────────────────────────────┐   │
│  │                      Network Security                                   │   │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐    │   │
│  │  │   TLS/SSL   │  │  Firewall   │  │  Network    │  │    Rate     │    │   │
│  │  │Encryption   │  │   Rules     │  │ Segmentation│  │  Limiting   │    │   │
│  │  │             │  │             │  │             │  │             │    │   │
│  │  │ • TLS 1.3   │  │ • UFW       │  │ • VPC       │  │ • Per IP    │    │   │
│  │  │ • HSTS      │  │ • Specific  │  │ • Subnets   │  │ • Per User  │    │   │
│  │  │ • OCSP      │  │ • Ports     │  │ • Security  │  │ • Global    │    │   │
│  │  └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘    │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │
│                                                                                 │
│  ┌─────────────────────────────────────────────────────────────────────────┐   │
│  │                        Data Security                                    │   │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐    │   │
│  │  │ Encryption  │  │    Key      │  │   Backup    │  │   Audit     │    │   │
│  │  │  at Rest    │  │ Management  │  │ Encryption  │  │   Trails    │    │   │
│  │  │             │  │             │  │             │  │             │    │   │
│  │  │ • AES-256   │  │ • RSA-2048  │  │ • Automated │  │ • All Ops   │    │   │
│  │  │ • Database  │  │ • Rotation  │  │ • Verified  │  │ • Immutable │    │   │
│  │  │ • Files     │  │ • Secure    │  │ • Offsite   │  │ • Searchable│    │   │
│  │  └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘    │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │
│                                                                                 │
└─────────────────────────────────────────────────────────────────────────────────┘
```

## 📊 Data Flow Architecture

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                              Data Sources                                       │
├─────────────────────────────────────────────────────────────────────────────────┤
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐       │
│  │   Target     │  │   OpenSCAP   │  │    Agent     │  │    API       │       │
│  │   Systems    │  │   Scanner    │  │    Logs      │  │   Requests   │       │
│  └──────┬───────┘  └──────┬───────┘  └──────┬───────┘  └──────┬───────┘       │
│         │                 │                 │                 │               │
└─────────┼─────────────────┼─────────────────┼─────────────────┼───────────────┘
          │                 │                 │                 │
          ▼                 ▼                 ▼                 ▼
┌─────────────────────────────────────────────────────────────────────────────────┐
│                           Data Ingestion                                        │
├─────────────────────────────────────────────────────────────────────────────────┤
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐       │
│  │  System      │  │    Scan      │  │    Log       │  │    Event     │       │
│  │Registration  │  │   Results    │  │  Processing  │  │  Collection  │       │
│  │              │  │              │  │              │  │              │       │
│  │ • Validation │  │ • XML Parse  │  │ • Structure  │  │ • API Calls  │       │
│  │ • Enrichment │  │ • JSON Conv  │  │ • Filtering  │  │ • User Acts  │       │
│  │ • Storage    │  │ • Scoring    │  │ • Masking    │  │ • Sys Events │       │
│  └──────┬───────┘  └──────┬───────┘  └──────┬───────┘  └──────┬───────┘       │
│         │                 │                 │                 │               │
└─────────┼─────────────────┼─────────────────┼─────────────────┼───────────────┘
          │                 │                 │                 │
          ▼                 ▼                 ▼                 ▼
┌─────────────────────────────────────────────────────────────────────────────────┐
│                         Data Processing                                         │
├─────────────────────────────────────────────────────────────────────────────────┤
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐       │
│  │ Compliance   │  │ Attestation  │  │   Report     │  │   Metrics    │       │
│  │  Analysis    │  │ Generation   │  │ Generation   │  │ Calculation  │       │
│  │              │  │              │  │              │  │              │       │
│  │ • Scoring    │  │ • JWT Sign   │  │ • HTML       │  │ • Prometheus │       │
│  │ • Trends     │  │ • Claims     │  │ • JSON       │  │ • Grafana    │       │
│  │ • Alerts     │  │ • Verify     │  │ • PDF        │  │ • Alerts     │       │
│  └──────┬───────┘  └──────┬───────┘  └──────┬───────┘  └──────┬───────┘       │
│         │                 │                 │                 │               │
└─────────┼─────────────────┼─────────────────┼─────────────────┼───────────────┘
          │                 │                 │                 │
          ▼                 ▼                 ▼                 ▼
┌─────────────────────────────────────────────────────────────────────────────────┐
│                           Data Storage                                          │
├─────────────────────────────────────────────────────────────────────────────────┤
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐       │
│  │ PostgreSQL   │  │    Redis     │  │ File System  │  │   External   │       │
│  │   Primary    │  │    Cache     │  │   Storage    │  │   Backup     │       │
│  │              │  │              │  │              │  │              │       │
│  │ • ACID       │  │ • Sessions   │  │ • Reports    │  │ • S3/GCS     │       │
│  │ • Audit      │  │ • Temp Data  │  │ • Logs       │  │ • Encrypted  │       │
│  │ • Encrypted  │  │ • Metrics    │  │ • Keys       │  │ • Versioned  │       │
│  └──────────────┘  └──────────────┘  └──────────────┘  └──────────────┘       │
└─────────────────────────────────────────────────────────────────────────────────┘
```

## 🔄 Deployment Architecture

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                          Production Environment                                  │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                 │
│  ┌─────────────────────────────────────────────────────────────────────────┐   │
│  │                         Load Balancer                                   │   │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐    │   │
│  │  │    HAProxy  │  │    Nginx    │  │   Traefik   │  │   AWS ALB   │    │   │
│  │  │             │  │             │  │             │  │             │    │   │
│  │  │ • L4/L7     │  │ • SSL Term  │  │ • Auto Disc │  │ • Health    │    │   │
│  │  │ • Health    │  │ • Compress  │  │ • Let's Enc │  │ • Scaling   │    │   │
│  │  │ • Sticky    │  │ • Cache     │  │ • Metrics   │  │ • WAF       │    │   │
│  │  └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘    │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │
│                                    │                                           │
│                                    ▼                                           │
│  ┌─────────────────────────────────────────────────────────────────────────┐   │
│  │                       Application Tier                                  │   │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐    │   │
│  │  │  Instance   │  │  Instance   │  │  Instance   │  │   Worker    │    │   │
│  │  │     #1      │  │     #2      │  │     #3      │  │    Pool     │    │   │
│  │  │             │  │             │  │             │  │             │    │   │
│  │  │ • API       │  │ • API       │  │ • API       │  │ • Scans     │    │   │
│  │  │ • Auth      │  │ • Auth      │  │ • Auth      │  │ • Reports   │    │   │
│  │  │ • Metrics   │  │ • Metrics   │  │ • Metrics   │  │ • Tasks     │    │   │
│  │  └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘    │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │
│                                    │                                           │
│                                    ▼                                           │
│  ┌─────────────────────────────────────────────────────────────────────────┐   │
│  │                         Data Tier                                       │   │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐    │   │
│  │  │ PostgreSQL  │  │ Redis       │  │ Object      │  │ Message     │    │   │
│  │  │ Cluster     │  │ Cluster     │  │ Storage     │  │ Queue       │    │   │
│  │  │             │  │             │  │             │  │             │    │   │
│  │  │ • Primary   │  │ • Master    │  │ • Reports   │  │ • Tasks     │    │   │
│  │  │ • Replica   │  │ • Sentinel  │  │ • Backups   │  │ • Events    │    │   │
│  │  │ • Backup    │  │ • Cache     │  │ • Files     │  │ • Alerts    │    │   │
│  │  └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘    │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │
│                                                                                 │
└─────────────────────────────────────────────────────────────────────────────────┘
```

## 🔧 Monitoring Architecture

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                           Observability Stack                                   │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                 │
│  ┌─────────────────────────────────────────────────────────────────────────┐   │
│  │                      Metrics Collection                                 │   │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐    │   │
│  │  │ Prometheus  │  │   Node      │  │ Application │  │   Custom    │    │   │
│  │  │   Server    │  │ Exporter    │  │   Metrics   │  │  Exporters  │    │   │
│  │  │             │  │             │  │             │  │             │    │   │
│  │  │ • Scraping  │  │ • CPU/Mem   │  │ • Counters  │  │ • Business  │    │   │
│  │  │ • Storage   │  │ • Disk I/O  │  │ • Gauges    │  │ • Security  │    │   │
│  │  │ • Alerting  │  │ • Network   │  │ • Histograms│  │ • Compliance│    │   │
│  │  └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘    │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │
│                                    │                                           │
│                                    ▼                                           │
│  ┌─────────────────────────────────────────────────────────────────────────┐   │
│  │                     Visualization & Alerting                            │   │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐    │   │
│  │  │   Grafana   │  │ AlertManager│  │  PagerDuty  │  │    Slack    │    │   │
│  │  │ Dashboards  │  │    Rules    │  │ Integration │  │ Integration │    │   │
│  │  │             │  │             │  │             │  │             │    │   │
│  │  │ • Executive │  │ • Thresholds│  │ • On-Call   │  │ • Team      │    │   │
│  │  │ • Technical │  │ • Routing   │  │ • Escalation│  │ • Channels  │    │   │
│  │  │ • Security  │  │ • Grouping  │  │ • SMS/Voice │  │ • Bots      │    │   │
│  │  └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘    │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │
│                                    │                                           │
│                                    ▼                                           │
│  ┌─────────────────────────────────────────────────────────────────────────┐   │
│  │                        Log Management                                   │   │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐    │   │
│  │  │    ELK      │  │   Loki      │  │   Fluentd   │  │   Splunk    │    │   │
│  │  │   Stack     │  │   Stack     │  │  Aggregator │  │ Enterprise  │    │   │
│  │  │             │  │             │  │             │  │             │    │   │
│  │  │ • Search    │  │ • Labels    │  │ • Routing   │  │ • Security  │    │   │
│  │  │ • Index     │  │ • Streams   │  │ • Transform │  │ • Analytics │    │   │
│  │  │ • Kibana    │  │ • Grafana   │  │ • Storage   │  │ • Machine   │    │   │
│  │  └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘    │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │
│                                                                                 │
└─────────────────────────────────────────────────────────────────────────────────┘
```

These diagrams provide a comprehensive visual representation of the technical architecture, showing how all components interact and the flow of data through the system.
